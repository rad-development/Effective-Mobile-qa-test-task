# Проверка каскадного удаления данных в SQL

## Задание 4

Проверка того, что при удалении пользователя данные из связанных таблиц (например, `orders`) удаляются корректно.

## Шаги проверки с тестовыми данными

### 1. Добавляем тестового пользователя и сохраняем его ID

```sql
INSERT INTO users (name, email, age, status) 
VALUES ('Тест', 'test@test.com', 99, 'active');

SET @test_user_id = LAST_INSERT_ID();
```

### 2. Добавляем для него тестовые заказы

```sql
INSERT INTO orders (id, user_id, product, amount) 
VALUES 
(1001, @test_user_id, 'Тестовый товар 1', 1),
(1002, @test_user_id, 'Тестовый товар 2', 2);
```

### 3. Проверяем, что данные добавились

```sql
SELECT * FROM orders WHERE user_id = @test_user_id;
```

### 4. Удаляем тестового пользователя

```sql
DELETE FROM users WHERE id = @test_user_id;
```

### 5. Проверяем, удалились ли связанные заказы

```sql
SELECT * FROM orders WHERE user_id = @test_user_id;
```

Если каскадное удаление (`ON DELETE CASCADE`) настроено правильно, результат будет пустым, а остальные данные в `orders` останутся нетронутыми.


## Вывод

Создание тестового пользователя и связанных записей позволяет безопасно проверить работу каскадного удаления без риска потери реальных данных. Использование переменной `@test_user_id` гарантирует корректное связывание заказов с нужным пользователем даже на многопользовательской базе.
